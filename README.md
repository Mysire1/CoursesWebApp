# Система Управління Курсами (Веб-версія)

Веб-додаток для управління мовними курсами, створений на ASP.NET Core MVC з використанням PostgreSQL.

## Функції

- **Управління студентами**: Додавання, редагування, перегляд студентів
- **Аутентифікація**: Реєстрація та вхід для студентів та викладачів
- **Аналітичні запити**: 10 різних запитів для аналізу даних
- **Розрахунок вартості**: Автоматичний розрахунок вартості курсів
- **Управління знижками**: Автоматичне надання знижок за лояльність
- **Ціноутворення для груп**: Надбавки для малих груп, знижки для великих
- **Розклад занять**: Перегляд розкладу по групах та викладачах

## Технології

- ASP.NET Core 8.0 MVC
- Entity Framework Core
- PostgreSQL
- Bootstrap 5
- jQuery
- C#

## Вимоги

- .NET 8.0 SDK
- PostgreSQL 12+
- Visual Studio 2022 або VS Code

## Налаштування та запуск

### 1. Клонування репозиторію

```bash
git clone https://github.com/Mysire1/CoursesWebApp.git
cd CoursesWebApp
```

### 2. Налаштування PostgreSQL

1. Встановіть та запустіть PostgreSQL
2. Створіть базу даних:

```sql
CREATE DATABASE courseswebapp;
```

3. Переконайтеся, що користувач `postgres` з паролем `root` має доступ до бази

### 3. Налаштування підключення

Відкрийте `appsettings.json` та за потреби змініть рядок підключення:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=courseswebapp;Username=postgres;Password=root"
  }
}
```

### 4. Встановлення залежностей

```bash
dotnet restore
```

### 5. Створення та заповнення бази даних

При першому запуску додаток автоматично:
- Створить всі необхідні таблиці
- Заповнить початковими даними (студенти, викладачі, мови, рівні)

### 6. Запуск додатку

```bash
dotnet run
```

Додаток буде доступний за адресою: `https://localhost:5001` або `http://localhost:5000`

## ⚠️ Міграція з попередньої версії

Якщо ви оновлюєтеся з версії, де використовувалася таблиця `Users`, виконайте наступні кроки:

### 1. Створіть резервну копію бази даних

```bash
pg_dump -U postgres courseswebapp > backup_before_migration.sql
```

### 2. Запустіть міграційний скрипт

```bash
psql -U postgres -d courseswebapp -f Migrations/RemoveUserTableMigration.sql
```

### 3. Перезапустіть додаток

Міграційний скрипт:
- Додасть поля аутентифікації до `Students` та `Teachers`
- Мігрує дані з `Users` таблиці
- Видаляє `Users` таблицю

## Зміни в аутентифікації

### Що змінилося:

1. **Відсутність окремої таблиці User**
   - Аутентифікація тепер безпосередньо в `Students` та `Teachers`
   - Email використовується як унікальний ідентифікатор

2. **Реєстрація**
   - При реєстрації створюється запис в `Students` або `Teachers`
   - Відсутнє поле "Username" - тільки Email

3. **Вхід в систему**
   - Використовуйте Email замість Username
   - Система автоматично визначає роль (Студент/Викладач)

### Нові поля в Students:
- `Email` (обов'язкове, унікальне)
- `PasswordHash`
- `LastLoginAt`
- `IsActive`

### Нові поля в Teachers:
- `Email` (обов'язкове, унікальне)
- `PasswordHash`
- `LastLoginAt`
- `IsActive`

## Структура проєкту

```
CoursesWebApp/
├── Controllers/          # MVC контролери
├── Data/                # ApplicationDbContext
├── Migrations/          # SQL міграції
├── Models/              # Моделі даних
├── Services/            # Бізнес-логіка
│   └── Impl/           # Реалізації сервісів
├── Views/              # Razor-шаблони
│   ├── Home/
│   ├── Auth/
│   ├── Students/
│   ├── Queries/
│   └── Shared/
├── wwwroot/            # Статичні файли
│   ├── css/
│   └── js/
└── Program.cs          # Точка входу
```

## Початкові дані

При першому запуску автоматично створюються:

- **5 мов**: Англійська, Німецька, Французька, Іспанська, Італійська
- **5 викладачів**: З українськими іменами та контактами
- **10 рівнів**: Від Beginner (A1) до Advanced (C1) для різних мов
- **4 аудиторії**: З різним обладнанням та місткістю

## Підтримка

Якщо у вас виникли проблеми:

1. Перевірте, чи запущений PostgreSQL
2. Перевірте рядок підключення в `appsettings.json`
3. Переконайтеся, що порти 5000/5001 вільні
4. Перегляньте логи в консолі

## Ліцензія

МIT License

## Автор

Переробка з WPF на веб-версію виконана для навчальних цілей.
Оригінальний WPF додаток: [CoursesDekstopApp](https://github.com/Mysire1/CoursesDekstopApp)